var sigma={};sigma.tools={};sigma.classes={};sigma.instances={},function(){Array.prototype.some||(Array.prototype.some=function(n){var r=this.length,i,t;if(typeof n!="function")throw new TypeError;for(i=arguments[1],t=0;t<r;t++)if(t in this&&n.call(i,this[t],t,this))return!0;return!1});Array.prototype.forEach||(Array.prototype.forEach=function(n){var r=this.length,i,t;if(typeof n!="function")throw new TypeError;for(i=arguments[1],t=0;t<r;t++)t in this&&n.call(i,this[t],t,this)});Array.prototype.map||(Array.prototype.map=function(n){var r=this.length,i,u,t;if(typeof n!="function")throw new TypeError;for(i=new Array(r),u=arguments[1],t=0;t<r;t++)t in this&&(i[t]=n.call(u,this[t],t,this));return i});Array.prototype.filter||(Array.prototype.filter=function(n){var f=this.length,i,u,t,r;if(typeof n!="function")throw new TypeError;for(i=[],u=arguments[1],t=0;t<f;t++)t in this&&(r=this[t],n.call(u,r,t,this)&&i.push(r));return i});Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(u){var e,o,f;if(typeof u!="object"&&typeof u!="function"||u===null)throw new TypeError("Object.keys called on non-object");e=[];for(o in u)t.call(u,o)&&e.push(o);if(i)for(f=0;f<r;f++)t.call(u,n[f])&&e.push(n[f]);return e}}())}();sigma.classes.Cascade=function(){this.p={};this.config=function(n,t){var i,r;if(typeof n=="string"&&t==undefined)return this.p[n];i=typeof n=="object"&&t==undefined?n:{};typeof n=="string"&&(i[n]=t);for(r in i)this.p[r]!=undefined&&(this.p[r]=i[r]);return this}};sigma.classes.EventDispatcher=function(){function i(i,r){if(!r||!i)return t;var u=typeof i=="string"?i.split(" "):i;return u.forEach(function(t){n[t]||(n[t]=[]);n[t].push({h:r,one:!0})}),t}function r(i,r){if(!r||!i)return t;var u=typeof i=="string"?i.split(" "):i;return u.forEach(function(t){n[t]||(n[t]=[]);n[t].push({h:r,one:!1})}),t}function u(i,r){i||(n={});var u=typeof i=="string"?i.split(" "):i;return r?u.forEach(function(t){n[t]&&(n[t]=n[t].filter(function(n){return n.h!=r}));n[t]&&n[t].length==0&&delete n[t]}):u.forEach(function(t){delete n[t]}),t}function f(i,r){return n[i]&&(n[i].forEach(function(n){n.h({type:i,content:r,target:t})}),n[i]=n[i].filter(function(n){return!n.one})),t}var n={},t=this;this.one=i;this.bind=r;this.unbind=u;this.dispatch=f},function(){function r(){function u(t,i){var u,r;if(n.nodesIndex[t])throw new Error('Node "'+t+'" already exists.');i=i||{};u={x:0,y:0,size:1,degree:0,inDegree:0,outDegree:0,fixed:!1,active:!1,hidden:!1,forceLabel:!1,label:t.toString(),id:t.toString(),attr:{}};for(r in i)switch(r){case"id":break;case"x":case"y":case"size":u[r]=+i[r];break;case"fixed":case"active":case"hidden":case"forceLabel":u[r]=!!i[r];break;case"color":case"label":u[r]=i[r];break;default:u.attr[r]=i[r]}return n.nodes.push(u),n.nodesIndex[t.toString()]=u,n}function t(n){return{x:n.x,y:n.y,size:n.size,degree:n.degree,inDegree:n.inDegree,outDegree:n.outDegree,displayX:n.displayX,displayY:n.displayY,displaySize:n.displaySize,label:n.label,id:n.id,color:n.color,fixed:n.fixed,active:n.active,hidden:n.hidden,forceLabel:n.forceLabel,attr:n.attr}}function f(t,i){for(var r in i)switch(r){case"id":case"attr":case"degree":case"inDegree":case"outDegree":case"displayX":case"displayY":case"displaySize":break;case"x":case"y":case"size":t[r]=+i[r];break;case"fixed":case"active":case"hidden":case"forceLabel":t[r]=!!i[r];break;case"color":case"label":t[r]=(i[r]||"").toString();break;default:t.attr[r]=i[r]}return n}function e(t){var u=(t instanceof Array?t:[t])||[],i={},r;return u.forEach(function(t){n.nodesIndex[t]?i[t]=!0:sigma.log('Node "'+t+'" does not exist.')}),r=[],n.nodes.forEach(function(n,t){n.id in i&&(r.unshift(t),n.degree==0&&delete i[n.id])}),r.forEach(function(t){n.nodes.splice(t,1)}),n.edges=n.edges.filter(function(t){return t.source.id in i?(delete n.edgesIndex[t.id],t.target.degree--,t.target.inDegree--,!1):t.target.id in i?(delete n.edgesIndex[t.id],t.source.degree--,t.source.outDegree--,!1):!0}),n}function o(t,i,r,u){var o,f,e;if(n.edgesIndex[t])throw new Error('Edge "'+t+'" already exists.');if(!n.nodesIndex[i]){o="Edge's source \""+i+'" does not exist yet.';throw new Error(o);}if(!n.nodesIndex[r]){o="Edge's target \""+r+'" does not exist yet.';throw new Error(o);}u=u||{};f={source:n.nodesIndex[i],target:n.nodesIndex[r],size:1,weight:1,displaySize:.5,label:t.toString(),id:t.toString(),hidden:!1,attr:{}};f.source.degree++;f.source.outDegree++;f.target.degree++;f.target.inDegree++;for(e in u)switch(e){case"id":case"source":case"target":break;case"hidden":f[e]=!!u[e];break;case"size":case"weight":f[e]=+u[e];break;case"color":case"arrow":case"type":f[e]=u[e].toString();break;case"label":f[e]=u[e];break;default:f.attr[e]=u[e]}return n.edges.push(f),n.edgesIndex[t.toString()]=f,n}function i(n){return{source:n.source.id,target:n.target.id,size:n.size,type:n.type,arrow:n.arrow,weight:n.weight,displaySize:n.displaySize,label:n.label,hidden:n.hidden,id:n.id,attr:n.attr,color:n.color}}function s(t,i){for(var r in i)switch(r){case"id":case"displaySize":break;case"weight":case"size":t[r]=+i[r];break;case"source":case"target":t[r]=n.nodesIndex[r]||t[r];break;case"hidden":t[r]=!!i[r];break;case"color":case"label":case"arrow":case"type":t[r]=(i[r]||"").toString();break;default:t.attr[r]=i[r]}return n}function h(t){var i=(t instanceof Array?t:[t])||[];return i.forEach(function(t){if(n.edgesIndex[t]){n.edgesIndex[t].source.degree--;n.edgesIndex[t].source.outDegree--;n.edgesIndex[t].target.degree--;n.edgesIndex[t].target.inDegree--;var i=null;n.edges.some(function(n,r){return n.id==t?(i=r,!0):!1});i!=null&&n.edges.splice(i,1);delete n.edgesIndex[t]}else sigma.log('Edge "'+t+'" does not exist.')}),n}function r(){return n.nodes=[],n.nodesIndex={},n.edges=[],n.edgesIndex={},n}function c(t,i,r,u){var c=0,h=0,f,e,o,s,l,a,v,y,p,w;return r&&n.nodes.forEach(function(n){h=Math.max(n.size,h)}),u&&n.edges.forEach(function(n){c=Math.max(n.size,c)}),h=h||1,c=c||1,r&&n.nodes.forEach(function(n){e=Math.max(n.x,e||n.x);f=Math.min(n.x,f||n.x);s=Math.max(n.y,s||n.y);o=Math.min(n.y,o||n.y)}),l=n.p.scalingMode=="outside"?Math.max(t/Math.max(e-f,1),i/Math.max(s-o,1)):Math.min(t/Math.max(e-f,1),i/Math.max(s-o,1)),a=(n.p.maxNodeSize||h)/l,e+=a,f-=a,s+=a,o-=a,l=n.p.scalingMode=="outside"?Math.max(t/Math.max(e-f,1),i/Math.max(s-o,1)):Math.min(t/Math.max(e-f,1),i/Math.max(s-o,1)),n.p.maxNodeSize||n.p.minNodeSize?n.p.maxNodeSize==n.p.minNodeSize?(v=0,y=n.p.maxNodeSize):(v=(n.p.maxNodeSize-n.p.minNodeSize)/h,y=n.p.minNodeSize):(v=1,y=0),n.p.maxEdgeSize||n.p.minEdgeSize?n.p.maxEdgeSize==n.p.minEdgeSize?(p=0,w=n.p.minEdgeSize):(p=(n.p.maxEdgeSize-n.p.minEdgeSize)/c,w=n.p.minEdgeSize):(p=1,w=0),r&&n.nodes.forEach(function(n){n.displaySize=n.size*v+y;n.fixed||(n.displayX=(n.x-(e+f)/2)*l+t/2,n.displayY=(n.y-(s+o)/2)*l+i/2)}),u&&n.edges.forEach(function(n){n.displaySize=n.size*p+w}),n}function l(t,i,r,u,f){var e=Math.pow(r,n.p.nodesPowRatio);return u&&n.nodes.forEach(function(n){n.fixed||(n.displayX=n.displayX*r+t,n.displayY=n.displayY*r+i);n.displaySize=n.displaySize*e}),f&&n.edges.forEach(function(t){t.displaySize=t.displaySize*Math.pow(r,n.p.edgesPowRatio);t.arrowDisplaySize=t.displaySize*3*e}),n}function a(){n.borders={};n.nodes.forEach(function(t){n.borders.minX=Math.min(n.borders.minX==undefined?t.displayX-t.displaySize:n.borders.minX,t.displayX-t.displaySize);n.borders.maxX=Math.max(n.borders.maxX==undefined?t.displayX+t.displaySize:n.borders.maxX,t.displayX+t.displaySize);n.borders.minY=Math.min(n.borders.minY==undefined?t.displayY-t.displaySize:n.borders.minY,t.displayY-t.displaySize);n.borders.maxY=Math.max(n.borders.maxY==undefined?t.displayY-t.displaySize:n.borders.maxY,t.displayY-t.displaySize)})}function v(t,i){var r,u,f,e=[],o=[];return n.nodes.forEach(function(n){if(n.hidden){n.hover=!1;return}r=Math.abs(n.displayX-t);u=Math.abs(n.displayY-i);f=n.displaySize;var s=n.hover,h=r<f&&u<f&&Math.sqrt(r*r+u*u)<f;s&&!h?(n.hover=!1,o.push(n.id)):h&&!s&&(n.hover=!0,e.push(n.id))}),e.length&&n.dispatch("overnodes",e),o.length&&n.dispatch("outnodes",o),n}function y(i,r){var u=r?r.map(function(t){return n.nodesIndex[t]}):n.nodes,e=u.map(t);return e.forEach(i),u.forEach(function(n,t){f(n,e[t])}),n}function p(t,r){var u=r?r.map(function(t){return n.edgesIndex[t]}):n.edges,f=u.map(i);return f.forEach(t),u.forEach(function(n,t){s(n,f[t])}),n}function w(i){var r=((i instanceof Array?i:[i])||[]).map(function(i){return t(n.nodesIndex[i])});return i instanceof Array?r:r[0]}function b(t){var r=((t instanceof Array?t:[t])||[]).map(function(t){return i(n.edgesIndex[t])});return t instanceof Array?r:r[0]}sigma.classes.Cascade.call(this);sigma.classes.EventDispatcher.call(this);var n=this;this.p={minNodeSize:0,maxNodeSize:0,minEdgeSize:0,maxEdgeSize:0,scalingMode:"inside",nodesPowRatio:.5,edgesPowRatio:0};this.borders={};r();this.addNode=u;this.addEdge=o;this.dropNode=e;this.dropEdge=h;this.iterEdges=p;this.iterNodes=y;this.getEdges=b;this.getNodes=w;this.empty=r;this.rescale=c;this.translate=l;this.setBorders=a;this.checkHover=v}function u(n,t){function r(){return i.monitoring||(i.monitoring=window.setInterval(f,1e3/i.p.fps)),i}function u(){return i.monitoring&&(window.clearInterval(i.monitoring),i.monitoring=null,i.p.dom.innerHTML=""),i}function f(){var t="",n;t+="<p>GLOBAL :<\/p>";for(n in i.p.globalProbes)t+="<p>"+n+" : "+i.p.globalProbes[n]()+"<\/p>";t+="<br><p>LOCAL :<\/p>";for(n in i.p.localProbes)t+="<p>"+n+" : "+i.p.localProbes[n]()+"<\/p>";return i.p.dom.innerHTML=t,i}sigma.classes.Cascade.call(this);var i=this;this.instance=n;this.monitoring=!1;this.p={fps:40,dom:t,globalProbes:{"Time (ms)":sigma.chronos.getExecutionTime,Queue:sigma.chronos.getQueuedTasksCount,Tasks:sigma.chronos.getTasksCount,FPS:sigma.chronos.getFPS},localProbes:{"Nodes count":function(){return i.instance.graph.nodes.length},"Edges count":function(){return i.instance.graph.edges.length}}};this.activate=r;this.desactivate=u}function f(n){function nt(n){return n.offsetX!=undefined&&n.offsetX||n.layerX!=undefined&&n.layerX||n.clientX!=undefined&&n.clientX}function tt(n){return n.offsetY!=undefined&&n.offsetY||n.layerY!=undefined&&n.layerY||n.clientY!=undefined&&n.clientY}function it(n){return n.wheelDelta!=undefined&&n.wheelDelta||n.detail!=undefined&&-n.detail}function rt(n){y=t.mouseX;p=t.mouseY;t.mouseX=nt(n);t.mouseY=tt(n);t.isMouseDown&&st(n);t.dispatch("move");n.preventDefault?n.preventDefault():n.returnValue=!1}function ut(n){t.p.mouseEnabled&&t.isMouseDown&&(t.isMouseDown=!1,t.dispatch("mouseup"),ot(),n.preventDefault?n.preventDefault():n.returnValue=!1)}function ft(n){t.p.mouseEnabled&&(t.isMouseDown=!0,y=t.mouseX,p=t.mouseY,t.dispatch("mousedown"),et(),n.preventDefault?n.preventDefault():n.returnValue=!1)}function k(n){t.p.mouseEnabled&&(v(t.mouseX,t.mouseY,t.ratio*(it(n)>0?t.p.zoomMultiply:1/t.p.zoomMultiply)),t.p.blockScroll&&(n.preventDefault?n.preventDefault():n.returnValue=!1))}function et(){e=t.stageX;o=t.stageY;w=t.mouseX;b=t.mouseY;h=t.stageX;c=t.stageX;l=t.stageY;a=t.stageY;t.dispatch("startdrag")}function ot(){(e!=t.stageX||o!=t.stageY)&&v(t.stageX+t.p.inertia*(t.stageX-c),t.stageY+t.p.inertia*(t.stageY-a))}function st(){var n=t.mouseX-w+e,i=t.mouseY-b+o;(n!=t.stageX||i!=t.stageY)&&(c=h,a=l,h=n,l=i,t.stageX=n,t.stageY=i,t.dispatch("drag"))}function v(n,h,c){t.isMouseDown||(window.clearInterval(t.interpolationID),s=c!=undefined,e=t.stageX,i=n,o=t.stageY,r=h,g=t.ratio,u=c||t.ratio,u=Math.min(Math.max(u,t.p.minRatio),t.p.maxRatio),f=t.p.directZooming?1-(s?t.p.zoomDelta:t.p.dragDelta):0,(t.ratio!=u||t.stageX!=i||t.stageY!=r)&&(d(),t.interpolationID=window.setInterval(d,50),t.dispatch("startinterpolate")))}function ht(){var n=t.ratio;s?(t.ratio=u,t.stageX=i+(t.stageX-i)*t.ratio/n,t.stageY=r+(t.stageY-r)*t.ratio/n):(t.stageX=i,t.stageY=r);t.dispatch("stopinterpolate")}function d(){f+=s?t.p.zoomDelta:t.p.dragDelta;f=Math.min(f,1);var n=sigma.easing.quadratic.easeout(f),h=t.ratio;t.ratio=h*(1-n)+u*n;s?(t.stageX=i+(t.stageX-i)*t.ratio/h,t.stageY=r+(t.stageY-r)*t.ratio/h):(t.stageX=e*(1-n)+i*n,t.stageY=o*(1-n)+r*n);t.dispatch("interpolate");f>=1&&(window.clearInterval(t.interpolationID),ht())}function ct(){return t}var t,n;sigma.classes.Cascade.call(this);sigma.classes.EventDispatcher.call(this);t=this;n=n;this.p={minRatio:1,maxRatio:32,marginRatio:1,zoomDelta:.1,dragDelta:.3,zoomMultiply:2,directZooming:!1,blockScroll:!0,inertia:1.1,mouseEnabled:!0};var y=0,p=0,w=0,b=0,e=0,o=0,g=1,u=1,i=0,r=0,h=0,c=0,l=0,a=0,f=0,s=!1;this.stageX=0;this.stageY=0;this.ratio=1;this.mouseX=0;this.mouseY=0;this.isMouseDown=!1;n.addEventListener("DOMMouseScroll",k,!0);n.addEventListener("mousewheel",k,!0);n.addEventListener("mousemove",rt,!0);n.addEventListener("mousedown",ft,!0);document.addEventListener("mouseup",ut,!0);this.checkBorders=ct;this.interpolate=v}function o(n,t,i,r,u,f,o){function p(){for(var i=u.edges.length,n,t,r=0;r++<s.p.edgesSpeed&&s.currentEdgeIndex<i;)e=u.edges[s.currentEdgeIndex],n=e.source,t=e.target,e.hidden||n.hidden||t.hidden||!s.isOnScreen(n)&&!s.isOnScreen(t)?s.currentEdgeIndex++:d(u.edges[s.currentEdgeIndex++]);return s.currentEdgeIndex<i}function w(){for(var n=u.nodes.length,t=0;t++<s.p.nodesSpeed&&s.currentNodeIndex<n;)s.isOnScreen(u.nodes[s.currentNodeIndex])?k(u.nodes[s.currentNodeIndex++]):s.currentNodeIndex++;return s.currentNodeIndex<n}function b(){for(var n=u.nodes.length,t=0;t++<s.p.labelsSpeed&&s.currentLabelIndex<n;)s.isOnScreen(u.nodes[s.currentLabelIndex])?g(u.nodes[s.currentLabelIndex++]):s.currentLabelIndex++;return s.currentLabelIndex<n}function k(t){var r=Math.round(t.displaySize*10)/10,i=n;return i.fillStyle=t.color,i.beginPath(),i.arc(t.displayX,t.displayY,r,0,Math.PI*2,!0),i.closePath(),i.fill(),t.hover&&v(t),s}function d(n){var r=[n.source.displayX,n.source.displayY],u=[n.target.displayX,n.target.displayY],f=n.color,i,e,o;if(!f)switch(s.p.edgeColor){case"source":f=n.source.color||s.p.defaultNodeColor;break;case"target":f=n.target.color||s.p.defaultNodeColor;break;default:f=s.p.defaultEdgeColor}i=t;switch(n.type||s.p.defaultEdgeType){case"curve":i.strokeStyle=f;e=(r[0]+u[0])/2+(u[1]-r[1])/4;o=(r[1]+u[1])/2+(r[0]-u[0])/4;h("source",n.arrow)&&(r=c(i,r,n.source.displaySize,e,o,n.arrowDisplaySize));h("target",n.arrow)&&(u=c(i,u,n.target.displaySize,e,o,n.arrowDisplaySize));i.lineWidth=n.displaySize/3;i.beginPath();i.moveTo(r[0],r[1]);i.quadraticCurveTo(e,o,u[0],u[1]);i.stroke();break;case"line":default:i.strokeStyle=f;h("source",n.arrow)&&(r=c(i,r,n.source.displaySize,u[0],u[1],n.arrowDisplaySize));h("target",n.arrow)&&(u=c(i,u,n.target.displaySize,r[0],r[1],n.arrowDisplaySize));i.lineWidth=n.displaySize/3;i.beginPath();i.moveTo(r[0],r[1]);i.lineTo(u[0],u[1]);i.stroke()}return s}function g(n){var t=i,r;return(n.displaySize>=s.p.labelThreshold||n.forceLabel)&&(r=s.p.labelSize=="fixed"?s.p.defaultLabelSize:s.p.labelSizeRatio*n.displaySize,t.font=s.p.fontStyle+r+"px "+s.p.font,t.fillStyle=s.p.labelColor=="node"?n.color||s.p.defaultNodeColor:s.p.defaultLabelColor,t.fillText(n.label,Math.round(n.displayX-n.displaySize/4),Math.round(n.displayY+n.displaySize/4))),s}function v(n){var t=r,i=s.p.labelSize=="fixed"?s.p.defaultLabelSize:s.p.labelSizeRatio*n.displaySize;return t.font=(s.p.hoverFontStyle||s.p.fontStyle||"")+" "+i+"px "+(s.p.hoverFont||s.p.font||""),t.fillStyle=s.p.labelHoverBGColor=="node"?n.color||s.p.defaultNodeColor:s.p.defaultHoverLabelBGColor,t.beginPath(),s.p.labelHoverShadow&&(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=4,t.shadowColor=s.p.labelHoverShadowColor),sigma.tools.drawRoundRect(t,Math.round(n.displayX-i/2-2),Math.round(n.displayY-i/2-2),Math.round(t.measureText(n.label).width+n.displaySize*1.5+i/2+4),Math.round(i+4),Math.round(i/2+2),"left"),t.closePath(),t.fill(),t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.beginPath(),t.fillStyle=s.p.nodeBorderColor=="node"?n.color||s.p.defaultNodeColor:s.p.defaultNodeBorderColor,t.arc(Math.round(n.displayX),Math.round(n.displayY),n.displaySize+s.p.borderSize,0,Math.PI*2,!0),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=s.p.nodeHoverColor=="node"?n.color||s.p.defaultNodeColor:s.p.defaultNodeHoverColor,t.arc(Math.round(n.displayX),Math.round(n.displayY),n.displaySize,0,Math.PI*2,!0),t.closePath(),t.fill(),t.fillStyle=s.p.labelHoverColor=="node"?n.color||s.p.defaultNodeColor:s.p.defaultLabelHoverColor,t.fillText(n.label,Math.round(n.displayX+n.displaySize*1.5),Math.round(n.displayY+i/2-3)),s}function nt(n){var t=r,i;return y(n)?(i=s.p.labelSize=="fixed"?s.p.defaultLabelSize:s.p.labelSizeRatio*n.displaySize,t.font=(s.p.activeFontStyle||s.p.fontStyle||"")+" "+i+"px "+(s.p.activeFont||s.p.font||""),t.fillStyle=s.p.labelHoverBGColor=="node"?n.color||s.p.defaultNodeColor:s.p.defaultActiveLabelBGColor,t.beginPath(),s.p.labelActiveShadow&&(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=4,t.shadowColor=s.p.labelActiveShadowColor),sigma.tools.drawRoundRect(t,Math.round(n.displayX-i/2-2),Math.round(n.displayY-i/2-2),Math.round(t.measureText(n.label).width+n.displaySize*1.5+i/2+4),Math.round(i+4),Math.round(i/2+2),"left"),t.closePath(),t.fill(),t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.beginPath(),t.fillStyle=s.p.nodeBorderColor=="node"?n.color||s.p.defaultNodeColor:s.p.defaultNodeBorderColor,t.arc(Math.round(n.displayX),Math.round(n.displayY),n.displaySize+s.p.borderSize,0,Math.PI*2,!0),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=s.p.nodeActiveColor=="node"?n.color||s.p.defaultNodeColor:s.p.defaultNodeActiveColor,t.arc(Math.round(n.displayX),Math.round(n.displayY),n.displaySize,0,Math.PI*2,!0),t.closePath(),t.fill(),t.fillStyle=s.p.labelActiveColor=="node"?n.color||s.p.defaultNodeColor:s.p.defaultLabelActiveColor,t.fillText(n.label,Math.round(n.displayX+n.displaySize*1.5),Math.round(n.displayY+i/2-3)),s):s}function y(n){if(isNaN(n.x)||isNaN(n.y))throw new Error("A node's coordinate is not a number (id: "+n.id+")");return!n.hidden&&n.displayX+n.displaySize>-l/3&&n.displayX-n.displaySize<l*4/3&&n.displayY+n.displaySize>-a/3&&n.displayY-n.displaySize<a*4/3}function tt(n,t){return l=n,a=t,s}function h(n,t){return t==n||t=="both"||!t&&(s.p.defaultEdgeArrow==n||s.p.defaultEdgeArrow=="both")}function c(n,t,i,r,u,f){var e=t[0]-r,o=t[1]-u,s=i/Math.sqrt(e*e+o*o);return t[0]=t[0]-e*s,t[1]=t[1]-o*s,n.lineWidth=0,n.fillStyle=n.strokeStyle,sigma.tools.drawArrowhead(n,t[0],t[1],f,sigma.tools.getIncidenceAngle(r,u,t[0],t[1])),t}var s;sigma.classes.Cascade.call(this);s=this;this.p={labelColor:"default",defaultLabelColor:"#000",labelHoverBGColor:"default",defaultHoverLabelBGColor:"#fff",labelHoverShadow:!0,labelHoverShadowColor:"#000",labelHoverColor:"default",defaultLabelHoverColor:"#000",labelActiveBGColor:"default",defaultActiveLabelBGColor:"#fff",labelActiveShadow:!0,labelActiveShadowColor:"#000",labelActiveColor:"default",defaultLabelActiveColor:"#000",labelSize:"fixed",defaultLabelSize:12,labelSizeRatio:2,labelThreshold:6,font:"Arial",hoverFont:"",activeFont:"",fontStyle:"",hoverFontStyle:"",activeFontStyle:"",edgeColor:"source",defaultEdgeColor:"#aaa",defaultEdgeType:"line",defaultEdgeArrow:"none",defaultNodeColor:"#aaa",nodeHoverColor:"node",defaultNodeHoverColor:"#fff",nodeActiveColor:"node",defaultNodeActiveColor:"#fff",borderSize:0,nodeBorderColor:"node",defaultNodeBorderColor:"#fff",edgesSpeed:200,nodesSpeed:200,labelsSpeed:200};var n=n,t=t,i=i,r=r,u=u,l=f,a=o;this.currentEdgeIndex=0;this.currentNodeIndex=0;this.currentLabelIndex=0;this.task_drawLabel=b;this.task_drawEdge=p;this.task_drawNode=w;this.drawActiveNode=nt;this.drawHoverNode=v;this.isOnScreen=y;this.resize=tt}function s(t,i){function v(n,t){var r=e.width,u=e.height,i;if(n!=undefined&&t!=undefined?(e.width=n,e.height=t):(e.width=e.domRoot.offsetWidth,e.height=e.domRoot.offsetHeight),r!=e.width||u!=e.height){for(i in e.domElements)e.domElements[i].setAttribute("width",e.width+"px"),e.domElements[i].setAttribute("height",e.height+"px");e.plotter.resize(e.width,e.height);e.draw(e.p.lastNodes,e.p.lastEdges,e.p.lastLabels,!0)}return e}function a(){return sigma.chronos.removeTask("node_"+e.id,2).removeTask("edge_"+e.id,2).removeTask("label_"+e.id,2).stopTasks(),e}function s(n,t){return e.domElements[n]=document.createElement(t),e.domElements[n].style.position="absolute",e.domElements[n].setAttribute("id","sigma_"+n+"_"+e.id),e.domElements[n].setAttribute("class","sigma_"+n+"_"+t),e.domElements[n].setAttribute("width",e.width+"px"),e.domElements[n].setAttribute("height",e.height+"px"),e.domRoot.appendChild(e.domElements[n]),e}function y(n,t,i,r){var f,u,h;if(r&&sigma.chronos.getGeneratorsIDs().some(function(n){return!!n.match(new RegExp("_ext_"+e.id+"$",""))}))return e;var o=n==undefined?e.p.drawNodes:n,s=t==undefined?e.p.drawEdges:t,c=i==undefined?e.p.drawLabels:i,l={nodes:o,edges:s,labels:c};e.p.lastNodes=o;e.p.lastEdges=s;e.p.lastLabels=c;a();e.graph.rescale(e.width,e.height,o>0,s>0).setBorders();e.mousecaptor.checkBorders(e.graph.borders,e.width,e.height);e.graph.translate(e.mousecaptor.stageX,e.mousecaptor.stageY,e.mousecaptor.ratio,o>0,s>0);e.dispatch("graphscaled");for(f in e.domElements)e.domElements[f].nodeName.toLowerCase()=="canvas"&&(l[f]==undefined||l[f]>=0)&&e.domElements[f].getContext("2d").clearRect(0,0,e.domElements[f].width,e.domElements[f].height);if(e.plotter.currentEdgeIndex=0,e.plotter.currentNodeIndex=0,e.plotter.currentLabelIndex=0,u=null,h=!1,o)if(o>1)while(e.plotter.task_drawNode());else sigma.chronos.addTask(e.plotter.task_drawNode,"node_"+e.id,!1),h=!0,u="node_"+e.id;if(c)if(c>1)while(e.plotter.task_drawLabel());else u?sigma.chronos.queueTask(e.plotter.task_drawLabel,"label_"+e.id,u):sigma.chronos.addTask(e.plotter.task_drawLabel,"label_"+e.id,!1),h=!0,u="label_"+e.id;if(s)if(s>1)while(e.plotter.task_drawEdge());else u?sigma.chronos.queueTask(e.plotter.task_drawEdge,"edge_"+e.id,u):sigma.chronos.addTask(e.plotter.task_drawEdge,"edge_"+e.id,!1),h=!0,u="edge_"+e.id;return e.dispatch("draw"),e.refresh(),h&&sigma.chronos.runTasks(),e}function p(){return e.domElements.hover.getContext("2d").clearRect(0,0,e.domElements.hover.width,e.domElements.hover.height),c(),l(),e}function c(){return e.p.drawHoverNodes&&(e.graph.checkHover(e.mousecaptor.mouseX,e.mousecaptor.mouseY),e.graph.nodes.forEach(function(n){n.hover&&!n.active&&e.plotter.drawHoverNode(n)})),e}function l(){return e.p.drawActiveNodes&&e.graph.nodes.forEach(function(n){n.active&&e.plotter.drawActiveNode(n)}),e}var e,h;for(sigma.classes.Cascade.call(this),sigma.classes.EventDispatcher.call(this),e=this,this.id=i.toString(),this.p={auto:!0,drawNodes:2,drawEdges:1,drawLabels:2,lastNodes:2,lastEdges:0,lastLabels:2,drawHoverNodes:!0,drawActiveNodes:!0},this.domRoot=t,this.width=this.domRoot.offsetWidth,this.height=this.domRoot.offsetHeight,this.graph=new r,this.domElements={},s("edges","canvas"),s("nodes","canvas"),s("labels","canvas"),s("hover","canvas"),s("monitor","div"),s("mouse","canvas"),this.plotter=new o(this.domElements.nodes.getContext("2d"),this.domElements.edges.getContext("2d"),this.domElements.labels.getContext("2d"),this.domElements.hover.getContext("2d"),this.graph,this.width,this.height),this.monitor=new u(this,this.domElements.monitor),this.mousecaptor=new f(this.domElements.mouse,this.id),this.mousecaptor.bind("drag interpolate",function(){e.draw(e.p.auto?2:e.p.drawNodes,e.p.auto?0:e.p.drawEdges,e.p.auto?2:e.p.drawLabels,!0)}).bind("stopdrag stopinterpolate",function(){e.draw(e.p.auto?2:e.p.drawNodes,e.p.auto?1:e.p.drawEdges,e.p.auto?2:e.p.drawLabels,!0)}).bind("mousedown mouseup",function(n){var t=e.graph.nodes.filter(function(n){return!!n.hover}).map(function(n){return n.id});e.dispatch(n.type=="mousedown"?"downgraph":"upgraph");t.length&&e.dispatch(n.type=="mousedown"?"downnodes":"upnodes",t)}).bind("move",function(){e.domElements.hover.getContext("2d").clearRect(0,0,e.domElements.hover.width,e.domElements.hover.height);c();l()}),sigma.chronos.bind("startgenerators",function(){sigma.chronos.getGeneratorsIDs().some(function(n){return!!n.match(new RegExp("_ext_"+e.id+"$",""))})&&e.draw(e.p.auto?2:e.p.drawNodes,e.p.auto?0:e.p.drawEdges,e.p.auto?2:e.p.drawLabels)}).bind("stopgenerators",function(){e.draw()}),h=0;h<n.plugins.length;h++)n.plugins[h](this);this.draw=y;this.resize=v;this.refresh=p;this.drawHover=c;this.drawActive=l;this.clearSchedule=a;window.addEventListener("resize",function(){e.resize()})}function i(n){var t=n,i=this;sigma.classes.EventDispatcher.call(this);this._core=n;this.kill=function(){};this.getID=function(){return t.id};this.configProperties=function(n,r){var u=t.config(n,r);return u==t?i:u};this.drawingProperties=function(n,r){var u=t.plotter.config(n,r);return u==t.plotter?i:u};this.mouseProperties=function(n,r){var u=t.mousecaptor.config(n,r);return u==t.mousecaptor?i:u};this.graphProperties=function(n,r){var u=t.graph.config(n,r);return u==t.graph?i:u};this.getMouse=function(){return{mouseX:t.mousecaptor.mouseX,mouseY:t.mousecaptor.mouseY,down:t.mousecaptor.isMouseDown}};this.position=function(n,r,u){return arguments.length==0?{stageX:t.mousecaptor.stageX,stageY:t.mousecaptor.stageY,ratio:t.mousecaptor.ratio}:(t.mousecaptor.stageX=n!=undefined?n:t.mousecaptor.stageX,t.mousecaptor.stageY=r!=undefined?r:t.mousecaptor.stageY,t.mousecaptor.ratio=u!=undefined?u:t.mousecaptor.ratio,i)};this.goTo=function(n,r,u){return t.mousecaptor.interpolate(n,r,u),i};this.zoomTo=function(n,r,u){return u=Math.min(Math.max(t.mousecaptor.config("minRatio"),u),t.mousecaptor.config("maxRatio")),u==t.mousecaptor.ratio?t.mousecaptor.interpolate(n-t.width/2+t.mousecaptor.stageX,r-t.height/2+t.mousecaptor.stageY):t.mousecaptor.interpolate((u*n-t.mousecaptor.ratio*t.width/2)/(u-t.mousecaptor.ratio),(u*r-t.mousecaptor.ratio*t.height/2)/(u-t.mousecaptor.ratio),u),i};this.resize=function(n,r){return t.resize(n,r),i};this.draw=function(n,r,u,f){return t.draw(n,r,u,f),i};this.refresh=function(){return t.refresh(),i};this.addGenerator=function(n,r,u){return sigma.chronos.addGenerator(n+"_ext_"+t.id,r,u),i};this.removeGenerator=function(n){return sigma.chronos.removeGenerator(n+"_ext_"+t.id),i};this.addNode=function(n,r){return t.graph.addNode(n,r),i};this.addEdge=function(n,r,u,f){return t.graph.addEdge(n,r,u,f),i};this.dropNode=function(n){return t.graph.dropNode(n),i};this.dropEdge=function(n){return t.graph.dropEdge(n),i};this.pushGraph=function(n,r){n.nodes&&n.nodes.forEach(function(n){!n.id||r&&t.graph.nodesIndex[n.id]||i.addNode(n.id,n)});return n.edges&&n.edges.forEach(function(n){validID=n.source&&n.target&&n.id;!validID||r&&t.graph.edgesIndex[n.id]||i.addEdge(n.id,n.source,n.target,n)}),i};this.emptyGraph=function(){return t.graph.empty(),i};this.getNodesCount=function(){return t.graph.nodes.length};this.getEdgesCount=function(){return t.graph.edges.length};this.iterNodes=function(n,r){return t.graph.iterNodes(n,r),i};this.iterEdges=function(n,r){return t.graph.iterEdges(n,r),i};this.getNodes=function(n){return t.graph.getNodes(n)};this.getEdges=function(n){return t.graph.getEdges(n)};this.activateMonitoring=function(){return t.monitor.activate()};this.desactivateMonitoring=function(){return t.monitor.desactivate()};t.bind("downnodes upnodes downgraph upgraph",function(n){i.dispatch(n.type,n.content)});t.graph.bind("overnodes outnodes",function(n){i.dispatch(n.type,n.content)})}var t=0,n={};n.plugins=[];sigma.init=function(n){var r=new s(n,(++t).toString());return sigma.instances[t]=new i(r),sigma.instances[t]};sigma.addPlugin=function(t,r,u){i.prototype[t]=r;n.plugins.push(u)};sigma.chronos=new function(){function c(t){return window.setTimeout(t,0),n}function k(){for(n.dispatch("frameinserted");u&&i.length&&it(););u&&i.length?(e=(new Date).getTime(),s++,b=a-h,w=h-b,n.dispatch("insertframe"),c(k)):l()}function it(){if(f=f%i.length,!i[f].task()){var t=i[f].taskName;r=r.filter(function(n){return n.taskParent==t&&i.push({taskName:n.taskName,task:n.task}),n.taskParent!=t});n.dispatch("killed",i.splice(f--,1)[0])}return f++,a=(new Date).getTime()-e,a<=w}function d(){return u=!0,f=0,s=0,e=(new Date).getTime(),v=e,n.dispatch("start"),n.dispatch("insertframe"),c(k),n}function l(){return n.dispatch("stop"),u=!1,n}function g(t,r,f){if(typeof t!="function")throw new Error('Task "'+r+'" is not a function');return i.push({taskName:r,task:t}),u=!!(u||f&&d()||!0),n}function rt(t,u,f){if(typeof t!="function")throw new Error('Task "'+u+'" is not a function');if(!i.concat(r).some(function(n){return n.taskName==f}))throw new Error('Parent task "'+f+'" of "'+u+'" is not attached.');return r.push({taskParent:f,taskName:u,task:t}),n}function ut(t,f){if(t==undefined)i=[],f==1?r=[]:f==2&&(i=r,r=[]),l();else{var e=typeof t=="string"?t:"";i=i.filter(function(n){return(typeof t=="string"?n.taskName==t:n.task==t)?(e=n.taskName,!1):!0});f>0&&(r=r.filter(function(n){return f==1&&n.taskParent==e&&i.push(n),n.taskParent!=e}))}return u=!!(!i.length||l()&&!1),n}function ft(i,r,u){return t[i]!=undefined?n:(t[i]={task:r,condition:u},nt(!0)==0&&y(),n)}function et(i){return t[i]&&(t[i].on=!1,t[i].del=!0),n}function nt(n){return n?Object.keys(t).filter(function(n){return!!t[n].on}).length:Object.keys(t).length}function ot(){return Object.keys(t)}function y(){return Object.keys(t).length?(n.dispatch("startgenerators"),n.unbind("killed",tt),c(function(){for(var n in t)t[n].on=!0,g(t[n].task,n,!1)}),n.bind("killed",tt).runTasks()):n.dispatch("stopgenerators"),n}function tt(n){t[n.content.taskName]!=undefined&&(t[n.content.taskName].del||!t[n.content.taskName].condition()?delete t[n.content.taskName]:t[n.content.taskName].on=!1,nt(!0)==0&&y())}function st(t){return t!=undefined?(o=Math.abs(1*t),h=1e3/o,s=0,n):o}function ht(){return u&&(p=Math.round(s/((new Date).getTime()-v)*1e4)/10),p}function ct(){return i.length}function lt(){return r.length}function at(){return e-v}sigma.classes.EventDispatcher.call(this);var n=this,u=!1,o=80,p=0,s=0,h=1e3/o,w=h,a=0,v=0,e=0,b=0,t={},i=[],r=[],f=0;return this.frequency=st,this.runTasks=d,this.stopTasks=l,this.insertFrame=c,this.addTask=g,this.queueTask=rt,this.removeTask=ut,this.addGenerator=ft,this.removeGenerator=et,this.startGenerators=y,this.getGeneratorsIDs=ot,this.getFPS=ht,this.getTasksCount=ct,this.getQueuedTasksCount=lt,this.getExecutionTime=at,this};sigma.debugMode=0;sigma.log=function(){var n;if(sigma.debugMode==1)for(n in arguments)console.log(arguments[n]);else if(sigma.debugMode>1)for(n in arguments)throw new Error(arguments[n]);return sigma};sigma.easing={linear:{},quadratic:{}};sigma.easing.linear.easenone=function(n){return n};sigma.easing.quadratic.easein=function(n){return n*n};sigma.easing.quadratic.easeout=function(n){return-n*(n-2)};sigma.easing.quadratic.easeinout=function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)};sigma.tools.drawRoundRect=function(n,t,i,r,u,f,e){var o=f?f:0,s=e?e:[];s=typeof s=="string"?s.split(" "):s;var h=o&&(s.indexOf("topleft")>=0||s.indexOf("top")>=0||s.indexOf("left")>=0),c=o&&(s.indexOf("topright")>=0||s.indexOf("top")>=0||s.indexOf("right")>=0),l=o&&(s.indexOf("bottomleft")>=0||s.indexOf("bottom")>=0||s.indexOf("left")>=0),a=o&&(s.indexOf("bottomright")>=0||s.indexOf("bottom")>=0||s.indexOf("right")>=0);n.moveTo(t,i+o);h?n.arcTo(t,i,t+o,i,o):n.lineTo(t,i);c?(n.lineTo(t+r-o,i),n.arcTo(t+r,i,t+r,i+o,o)):n.lineTo(t+r,i);a?(n.lineTo(t+r,i+u-o),n.arcTo(t+r,i+u,t+r-o,i+u,o)):n.lineTo(t+r,i+u);l?(n.lineTo(t+o,i+u),n.arcTo(t,i+u,t,i+u-o,o)):n.lineTo(t,i+u);n.lineTo(t,i+o)};sigma.tools.drawArrowhead=function(n,t,i,r,u){var f=22;n.beginPath();n.moveTo(t,i);var e=t+Math.cos(.017453292519943295*(f+u))*r,o=i+Math.sin(.017453292519943295*(f+u))*r,s=t+Math.cos(.017453292519943295*(u-f))*r,h=i+Math.sin(.017453292519943295*(u-f))*r;n.lineTo(e,o);n.quadraticCurveTo((t+e+s)/3,(i+o+h)/3,s,h);n.lineTo(t,i);n.fill()};sigma.tools.getRGB=function(n,t){var i,r;return n=n.toString(),i={r:0,g:0,b:0},n.length>=3&&n.charAt(0)=="#"&&(r=n.length-1,r==6?i={r:parseInt(n.charAt(1)+n.charAt(2),16),g:parseInt(n.charAt(3)+n.charAt(4),16),b:parseInt(n.charAt(5)+n.charAt(5),16)}:r==3&&(i={r:parseInt(n.charAt(1)+n.charAt(1),16),g:parseInt(n.charAt(2)+n.charAt(2),16),b:parseInt(n.charAt(3)+n.charAt(3),16)})),t&&(i=[i.r,i.g,i.b]),i};sigma.tools.rgbToHex=function(n,t,i){return sigma.tools.toHex(n)+sigma.tools.toHex(t)+sigma.tools.toHex(i)};sigma.tools.toHex=function(n){return(n=parseInt(n,10),isNaN(n))?"00":(n=Math.max(0,Math.min(n,255)),"0123456789ABCDEF".charAt((n-n%16)/16)+"0123456789ABCDEF".charAt(n%16))};sigma.tools.getIncidenceAngle=function(n,t,i,r){return(n<=i?180:0)+Math.atan((r-t)/(i-n))*180/Math.PI};sigma.publicPrototype=i.prototype}();
//# sourceMappingURL=sigma2.min.js.map
